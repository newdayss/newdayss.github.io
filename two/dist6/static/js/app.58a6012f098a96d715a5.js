webpackJsonp([1],{"+oT0":function(e,t){},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("7+uW"),o=n("R4Sj"),i={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]};var s=n("VU/8")({name:"app"},i,!1,function(e){n("hnzG")},null,null).exports,r=n("/ocq"),l=n("Xxa5"),c=n.n(l),u=n("exGp"),p=n.n(u),d="get/nearby/device",h=n("Zrlr"),f=n.n(h),v=n("wxAW"),m=n.n(v),w=n("//Fk"),g=n.n(w),k=n("aozt"),_=n.n(k),y=n("mvHQ"),x=n.n(y),b=n("mw3O"),C=n.n(b),M={url:"/route",baseURL:"https://api.test2.gzmypay.com/",method:"GET",transformRequest:[function(e){return e&&(e.CustData=x()(e.CustData),e=C.a.stringify(e)),e}],transformResponse:[function(e){return e}],headers:{"Content-Type":"application/x-www-form-urlencoded",token:window.localStorage.getItem("device_token")?window.localStorage.getItem("device_token"):""},paramsSerializer:function(e){return C.a.stringify(e)},timeout:1e4,withCredentials:!1,responseType:"json",onUploadProgress:function(e){},onDownloadProgress:function(e){},maxContentLength:2e3,validateStatus:function(e){return e>=200&&e<300},maxRedirects:5},P=function(){function e(t){f()(this,e),this.promise=t||new g.a(this.promiseExecutor.bind(this))}return m()(e,[{key:"asPromise",value:function(){return this.promise}},{key:"then",value:function(t,n){return new e(this.promise.then(t,n))}},{key:"catch",value:function(t){return new e(this.promise.catch(t))}},{key:"resolve",value:function(e){this.resolveFunction(e)}},{key:"reject",value:function(e){this.rejectFunction(e)}},{key:"promiseExecutor",value:function(e,t){this.resolveFunction=e,this.rejectFunction=t}}]),e}(),B={baseURL:"https://api.test2.gzmypay.com/",timeout:5e4,headers:{"Content-Type":"application/x-www-form-urlencoded",token:window.localStorage.getItem("device_token")?window.localStorage.getItem("device_token"):""}};_.a.interceptors.request.use(function(e){var t=window.localStorage.getItem("device_token");return void 0!==t&&"undefined"!==t&&""!==t&&null!==t?e.headers.token=t:console.info("device_token not found"),e}),_.a.interceptors.response.use(function(e){return e},function(e){return g.a.reject(e)});var z=function(){function e(){f()(this,e)}return m()(e,null,[{key:"ResponseHandle",value:function(e,t){switch(t.data.Error){case 1:Notification({title:"请求提示",message:t.data.Msg,type:"warning"}),e.reject(t.data.Msg);break;case 2:window.localStorage.user_status="platform_admin_pc_outlogin";break;default:e.resolve(t.data.Data)}}},{key:"Post",value:function(t,n){var a=new P;return _.a.post(t,n,M).then(function(t){e.ResponseHandle(a,t)}).catch(function(e){a.reject(e)}),a}},{key:"upLoadFile",value:function(t,n){var a=new P;return _.a.post(t,n,B).then(function(t){e.ResponseHandle(a,t)}).catch(function(e){console.info(e),a.reject(e)}),a}},{key:"Get",value:function(t){var n=new P;return _.a.get(t,M).then(function(t){e.ResponseHandle(n,t)}).catch(function(e){n.reject(e)}),n}}]),e}(),A={name:"hello",data:function(){return{checkpanel:!0,positionData:[],defaultPosition:[],showBoolean:!1,showPanel:!1}},methods:{showback:function(){this.showBoolean=!0,this.showPanel=!1},penaldown:function(){this.checkpanel=!1;var e=document.getElementById("panel"),t=document.getElementsByClassName("backbtnBox")[0];e.style.height="0rem",t.style.bottom=0,e.style.transition=".3s",t.style.transition=".3s"},penalup:function(){this.checkpanel=!0;var e=document.getElementById("panel"),t=document.getElementsByClassName("backbtnBox")[0];e.style.height="40%",t.style.bottom="40%",e.style.transition=".3s",t.style.transition=".3s"},distanceCula:function(e,t,n,a){var o=this.distanceLine(e),i=this.distanceLine(n),s=o-i,r=this.distanceLine(t)-this.distanceLine(a),l=2*Math.asin(Math.sqrt(Math.pow(Math.sin(s/2),2)+Math.cos(o)*Math.cos(i)*Math.pow(Math.sin(r/2),2)));return l*=6378.137,l=(l=Math.round(1e4*l)/10).toFixed(1)},distanceLine:function(e){return e*Math.PI/180},refreshFn:function(){if(this.positionData.length<=0)return!1;this.$refs.refresh.classList.toggle("refresh-rotate"),this.showBoolean=!0,this.showPanel=!1},create:function(){var e=this;return p()(c.a.mark(function t(){var n,a,o;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=e,(a=new AMap.Map("container",{resizeEnable:!0,zoom:13})).plugin("AMap.Geolocation",function(){var e,t=this;o=new AMap.Geolocation({enableHighAccuracy:!0,timeout:1e4,buttonOffset:new AMap.Pixel(10,20),zoomToAccuracy:!0,buttonPosition:"RB"}),a.addControl(o),o.getCurrentPosition(),AMap.event.addListener(o,"complete",(e=p()(c.a.mark(function e(o){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:[o.position.getLng(),o.position.getLat()],n.getDeviceData(o.position.getLng(),o.position.getLat(),a);case 2:case"end":return e.stop()}},e,t)})),function(t){return e.apply(this,arguments)})),AMap.event.addListener(o,"error",function(e){alert("定位失败"),[]})});case 3:case"end":return t.stop()}},t,e)}))()},showPath:function(e){var t;this.$refs.panel.innerHTML="",t=new AMap.Map("container",{resizeEnable:!0,zoom:13});var n=new AMap.Walking({map:t,panel:"panel"});this.showPanel=!0,this.showBoolean=!1,n.search(this.defaultPosition,[e.longitude,e.latitude])},getDeviceData:function(e,t,n){var a=this;return p()(c.a.mark(function o(){var i;return c.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return a.defaultPosition=[e,t],console.log(a.defaultPosition),o.next=4,z.Post(d,{longitude:e,latitude:t});case 4:if(i=o.sent,console.log(i),i.length&&!(i.length<0)){o.next=11;break}return alert("周边暂无设备"),o.abrupt("return");case 11:i.forEach(function(o){if(o.distance="",o.distance=a.distanceCula(t,e,o.address.latitude,o.address.longitude),o.default_pay=(parseFloat(o.default_pay)/100).toFixed(2),null!=o.address||""!=o.address){o.address.address=o.address.address.replace(o.address.province,""),o.address.address=o.address.address.replace(o.address.city,""),o.address.address=o.address.address.replace(o.address.county,"");var i=new AMap.Marker({map:n,position:[o.address.longitude,o.address.latitude],icon:new AMap.Icon({size:new AMap.Size(35,44),image:"http://webapi.amap.com/theme/v1.3/images/newpc/poi-1.png",imageOffset:new AMap.Pixel(-115,-90)})});i.setLabel({offset:new AMap.Pixel(-60,-30),content:""}),i.on("click",function(e){""==i.Qi.label.content?i.setLabel({offset:new AMap.Pixel(-60,-30),content:o.alias+"</br>地址："+o.address.address}):i.setLabel({offset:new AMap.Pixel(-60,-30),content:""})})}});case 12:a.showBoolean=!0,a.positionData=i;case 14:case"end":return o.stop()}},o,a)}))()}},mounted:function(){this.create()}},S={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"hello"},[n("div",{attrs:{id:"container"}}),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.showPanel,expression:"showPanel"}],staticClass:"backbtnBox"},[n("p",{on:{click:function(t){return e.showback()}}},[e._v("返回")]),e._v(" "),n("div",{staticClass:"penalBox"},[e.checkpanel?n("i",{staticClass:"lock lock-down",on:{click:function(t){return e.penaldown()}}}):n("i",{staticClass:"lock lock-up",on:{click:function(t){return e.penalup()}}})])]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.showPanel,expression:"showPanel"}],ref:"panel",attrs:{id:"panel"}}),e._v(" "),n("zx-popup",{attrs:{position:"bottom",height:"100%"},model:{value:e.showBoolean,callback:function(t){e.showBoolean=t},expression:"showBoolean"}},[n("zx-cell-group",[0!=e.positionData.length?n("div",e._l(e.positionData,function(t,a){return n("zx-cell-item",{key:"item",staticClass:"newStyle"},[n("div",{staticClass:"deviceLeft"},[n("p",[e._v(e._s(t.alias))]),e._v(" "),n("p",[e._v(e._s(t.address.address))])]),e._v(" "),n("div",{staticClass:"deviceMid"},[n("p",[e._v(e._s(t.default_pay)+"元起")]),e._v(" "),n("p",[e._v(e._s(t.distance)+"m")])]),e._v(" "),n("div",{staticClass:"deviceRight",on:{click:function(n){return e.showPath(t.address)}}},[n("p",[e._v("到这去")])])])}),1):n("div",[n("div",{staticClass:"noDevice"},[e._v("周边暂无设备")])])])],1)],1)},staticRenderFns:[]};var L=n("VU/8")(A,S,!1,function(e){n("edy8")},null,null).exports;a.a.use(r.a);var F=new r.a({routes:[{path:"/",name:"Hello",component:L}]}),R=(n("+oT0"),n("VvPS"),n("W1rh"),{name:"zx-cell-item",props:{title:String,arrow:{type:Boolean,default:!1},type:String,href:{type:[String,Object]}},methods:{clickFn:function(e){this.$emit("click")}}}),E={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return"link"==e.type?n("div",{staticClass:"cell-group-w",class:e.arrow?"arrow":"",on:{click:function(t){return e.clickFn(t)}}},[n("router-link",{attrs:{to:e.href}},[e._t("left"),e._v(" "),e._t("right"),e._v(" "),e._t("default")],2)],1):"label"==e.type?n("div",{staticClass:"cell-group-w label",class:e.arrow?"arrow":"",on:{click:function(t){return e.clickFn(t)}}},[e._t("left"),e._v(" "),e._t("right"),e._v(" "),e._t("default")],2):n("div",{staticClass:"cell-group-w",class:e.arrow?"arrow":"",on:{click:function(t){return e.clickFn(t)}}},[e._t("left"),e._v(" "),e._t("right"),e._v(" "),e._t("default")],2)},staticRenderFns:[]},D=n("VU/8")(R,E,!1,null,null,null).exports,N={name:"zx-cell-group",props:{title:String}},T={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"cell-grop"},[e.title?n("div",{staticClass:"cell-group-t"},[n("div",{staticClass:"cell-title",attrs:{title:"title"}},[e._v(e._s(e.title))])]):e._e(),e._v(" "),e._t("default"),e._v(" "),e._t("bottom")],2)},staticRenderFns:[]},j=n("VU/8")(N,T,!1,null,null,null).exports,$={name:"zx-popup",props:{value:{type:Boolean,default:!1},width:{type:String,default:"60%"},height:{type:String,default:"60%"},position:{type:String,default:"right"}},data:function(){return{show:this.value,locked:!0}},watch:{value:function(e){this.$refs.popup.className=e?"popup-group popup-show":"popup-group",this.show=e}},methods:{down:function(){this.locked=!1;var e=document.getElementsByClassName("popup-group")[0];e.style.height="3.2rem",e.style.transition=".3s"},up:function(){this.locked=!0;var e=document.getElementsByClassName("popup-group")[0];e.style.height="55%",e.style.transition=".3s"},click:function(e){this.$emit("click",e)},style:function(){return"right"==this.position||"left"==this.position?{width:this.width}:{height:this.height}},checkClass:function(){return"popup-cont-"+this.position},close:function(){this.show=!1,this.$emit("input",!1)},checkName:function(){return"popup-"+this.position}},created:function(){}},O={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("transition",{attrs:{name:e.checkName()}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}],ref:"popup",staticClass:"popup-group clearfixed"},[n("div",{staticClass:"nearClass"},[n("h2",[e._v("附近设备")]),e._v(" "),e.locked?n("i",{staticClass:"lock lock-down",on:{click:function(t){return e.down()}}}):n("i",{staticClass:"lock lock-up",on:{click:function(t){return e.up()}}})]),e._v(" "),n("div",{class:e.checkClass(),style:e.style()},[e._t("default")],2)])])},staticRenderFns:[]};var H=n("VU/8")($,O,!1,function(e){n("bxuP")},null,null).exports,V={name:"zx-button",data:function(){return{}},props:{type:{type:String,default:"info",validator:function(e){console.log(e)}},size:{type:String,default:"default"},disabled:{type:Boolean,default:!1}},methods:{checkClass:function(){var e="";return this.disabled&&(e="disabled"),"zx-button-"+this.type+" size-"+this.size+" "+e}}},I={render:function(){var e=this.$createElement,t=this._self._c||e;return t("button",{staticClass:"zx-button",class:this.checkClass(),attrs:{type:"button"}},[t("span",[this._t("default")],2)])},staticRenderFns:[]},U=n("VU/8")(V,I,!1,null,null,null).exports,G=function(e){e.component(j.name,j),e.component(D.name,D),e.component(H.name,H),e.component(U.name,U)};"undefined"!=typeof window&&window.Vue&&G(window.Vue);var W={install:G};a.a.use(o.a),a.a.config.productionTip=!1,a.a.use(W),new a.a({el:"#app",router:F,template:"<App/>",components:{App:s}})},VvPS:function(e,t){},W1rh:function(e,t){"undefined"!=typeof map&&map.on("complete",function(){-1!==location.href.indexOf("guide=1")&&(map.setStatus({scrollWheel:!1}),-1===location.href.indexOf("litebar=0")&&map.plugin(["AMap.ToolBar"],function(){var e={liteStyle:!0};-1!==location.href.indexOf("litebar=1")?(e.position="LT",e.offset=new AMap.Pixel(10,40)):-1!==location.href.indexOf("litebar=2")?(e.position="RT",e.offset=new AMap.Pixel(20,40)):-1!==location.href.indexOf("litebar=3")?e.position="LB":-1!==location.href.indexOf("litebar=4")&&(e.position="RB"),map.addControl(new AMap.ToolBar(e))}))})},bxuP:function(e,t){},edy8:function(e,t){},hnzG:function(e,t){}},["NHnr"]);