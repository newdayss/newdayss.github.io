webpackJsonp([40],{300:function(e,t,a){var i=a(14)(a(768),a(817),null,null);e.exports=i.exports},698:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.DeleteComboList=t.GetComboSetList=t.TemplateComboAdd=t.DeviceComboAdd=t.DeviceComboDelete=t.GetDeviceComboList=t.templateAdd=t.templateEdit=t.getTemplateDetail=t.templateRemove=t.templateRemoves=t.getDeviceComboList=t.PostAddressList=t.GetAddressList=t.updateDeviceAddress=t.DeleteAddressList=t.AddAddressData=t.RemoveBindDevice=t.updateDeviceTtemplate=t.getTemplateList=t.ChangeDevideStatus=t.AddDevice=t.EditDevice=t.lockDevice=t.PointsDevice=t.getDeviceDetail=t.GetDeviceList=void 0;var n=a(151),r=i(n),s=a(75),o=(i(s),a(98)),d=(i(o),a(152)),l=i(d),c=a(153),u=(i(c),a(97)),p=(i(u),function(e){var t="";for(var a in e)t+=a+"="+e[a]+"&";return"?"+t.substr(0,t.length-1)});t.GetDeviceList=function(e,t){return r.default.Get(l.default.device.list+p(e),t)},t.getDeviceDetail=function(e,t){return r.default.Get(l.default.device.details+p(e),t)},t.PointsDevice=function(e){return r.default.Post(l.default.device.topSplit,{device_id:e.device_id,device_sn:e.device_sn,coin_num:e.coin_num})},t.lockDevice=function(e){return r.default.Post(l.default.device.lockDevice,{device_id:e.device_id})},t.EditDevice=function(e){return r.default.Post(l.default.device.edit,e)},t.AddDevice=function(e){return r.default.Post(l.default.device.join,e)},t.ChangeDevideStatus=function(e){return r.default.Post(l.default.device.deviceStatus,{device_id:e.device_id,status:e.status})},t.getTemplateList=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return r.default.Post(l.default.device.templateList,e,t)},t.updateDeviceTtemplate=function(e){return r.default.Post(l.default.device.updateDeviceTtemplate,{ids:e.ids,device:e.device,toall:e.toall})},t.RemoveBindDevice=function(e){return r.default.Post(l.default.device.removeBind,{device_id:params.device_id})},t.AddAddressData=function(e){return r.default.Get(l.default.device.add+p(e))},t.DeleteAddressList=function(e){return r.default.Post(l.default.personal.del,{aId:e.aId})},t.updateDeviceAddress=function(e){return r.default.Post(l.default.personal.updateDeveceAddress,{id:e.id,province:e.province,city:e.city,county:e.county,addressType:e.addressType,latitude:e.latitude,longitude:e.longitude,address:e.address})},t.GetAddressList=function(e){var t="";for(var a in e)t+=a+"="+e[a]+"&";return r.default.Get(l.default.personal.list+"?"+t.substr(0,t.length-1))},t.PostAddressList=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return r.default.Post(l.default.personal.list,e,t)},t.getDeviceComboList=function(e,t){return r.default.Post(l.default.device.getTemplateFile,e,t)},t.templateRemoves=function(e){return r.default.Post(l.default.device.templateRemoves,{ids:e.ids})},t.templateRemove=function(e){return r.default.Post(l.default.device.templateRemove,{ids:e.ids})},t.getTemplateDetail=function(e,t){return r.default.Get(l.default.device.getTemplateDetail+p(e),t)},t.templateEdit=function(e){return r.default.Post(l.default.device.templateEdit,{name:e.name,id:e.id?e.id:"",default_pay:e.default_pay,alias:e.alias,address_id:e.address_id,combo_type:e.combo_type})},t.templateAdd=function(e){return r.default.Post(l.default.device.templateAdd,{name:e.name,id:e.id?e.id:"",default_pay:e.default_pay,alias:e.alias,address_id:e.address_id,combo_type:e.combo_type})},t.GetDeviceComboList=function(e){return r.default.Post(l.default.device.combo,{device_id:e.device_id})},t.DeviceComboDelete=function(e){return r.default.Post(l.default.device.deviceOneDelete,{id:e.id})},t.DeviceComboAdd=function(e){return r.default.Post(l.default.device.deviceOneAdd,{title:e.title,money:e.money,pulse:e.pulse,id:e.id})},t.TemplateComboAdd=function(e){return r.default.Post(l.default.device.templateComboAdd,{title:e.title,money:e.money,pulse:e.pulse,id:e.id})},t.GetComboSetList=function(e){return r.default.Post(l.default.device.getComboSetList,e)},t.DeleteComboList=function(e){return r.default.Post(l.default.device.deleteComboList,e)}},768:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,a){function i(n,r){try{var s=t[n](r),o=s.value}catch(e){return void a(e)}if(!s.done)return Promise.resolve(o).then(function(e){i("next",e)},function(e){i("throw",e)});e(o)}return i("next")})}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(151),s=i(r),o=a(152),d=i(o);a(698),t.default={data:function(){return{per_page_detail:10,per_page_detail_code:10,count_detail:0,isBtn:!1,dayNum:"",dialogTableVisible:!1,static:!0,statusSrceen:"",statusSrceenSort:"timeUp",aliSubmitBtnSn:!1,dialogUpdataAddress:!1,addressForm:{address_name:"",address_id:""},addressList:[],postData:{d_sn:"",ids:"",page_number:1,per_page:10,per_page_code:10,mode:"pay",address_id:"",template_id:"",time_cycle:"",sort_type:"timeUp"},address_name:"",per_page_code:10,deviceData:[],count:0,currentPage:1,rules:{address_id:{required:!0,message:"请选择场地地址"}},multipleSelection:[]}},methods:{changePageNumDetail:function(){this.per_page_detail!=this.per_page_detail_code&&(""!=this.per_page_detail&&0!=this.per_page_detail||(this.per_page_detail=1),this.getDetail())},handleCurrentChangeDetail:function(e){var t=this;return n(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:t.page_detail=e,t.getDetail();case 2:case"end":return a.stop()}},a,t)}))()},deviceReportExcelDeatil:function(){var e=this;return n(regeneratorRuntime.mark(function t(){var a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.getDetail(0,1);case 3:a=t.sent,window.location.href=a.url,t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log("Ajax Error");case 10:case"end":return t.stop()}},t,e,[[0,7]])}))()},getDetail:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return n(regeneratorRuntime.mark(function i(){var n,r,o,l;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(t.postData.time1&&t.showTime(t.postData.time1),n=new Map,n.set("日","day").set("月","month").set("周","week"),r={start_time:t.postData.time1?t.dayList[0]:"",end_time:t.postData.time1?t.dayList[1]:"",page:t.page_detail,per_page:t.per_page_detail,device_sn:t.detail_sn,type:t.postData.type?n.get(t.postData.type):"day",is_export:a},o=e||r,i.prev=5,l="","deviceOnline"!=t.needList){i.next=13;break}return i.next=10,s.default.Post(d.default.finance.financedetail,o);case 10:l=i.sent,i.next=16;break;case 13:return i.next=15,s.default.Post(d.default.finance.financedetailOff,o);case 15:l=i.sent;case 16:if(1!=a){i.next=18;break}return i.abrupt("return",l);case 18:t.detailList=l.list,t.count_detail=l.count,t.per_page_detail_code=parseInt(t.per_page_detail),t.detailList.forEach(function(e){e.money=parseFloat(e.money/100).toFixed(2)}),i.next=29;break;case 24:i.prev=24,i.t0=i.catch(5),t.count_detail=0,t.detailList=[],console.log(i.t0);case 29:case"end":return i.stop()}},i,t,[[5,24]])}))()},actiondialogTableVisible:function(){this.dialogTableVisible=!0},changeScreenLi:function(e){e!=this.statusSrceen&&(this.statusSrceen=e,this.postData.mode=e,this.SearchSubmit())},changeScreenLiSort:function(e){e!=this.statusSrceenSort&&(this.statusSrceenSort=e,this.postData.sort_type=e,this.SearchSubmit())},changepick:function(){this.isBtn||(this.dayNum="",this.SearchSubmit())},getnowDay:function(){var e=new Date,t=e.getMonth()+1,a=e.getDate(),i=e.getFullYear();return a=a<10?"0"+a:a,t=t<10?"0"+t:t,i+"-"+t+"-"+a},historyTime:function(e){var t=this;if(this.dayNum!=e){if(this.dayNum=e,!e)return this.dayList=[],this.postData.time_cycle="",void this.SearchSubmit();var a=new Date;if(1==e){var i=this.getnowDay();this.dayList=[],this.dayList[0]=i,this.dayList[1]=i;var n=[],r=(new Date).toUTCString();n[0]=r,n[1]=r,this.postData.time_cycle=n,this.isBtn=!0,setTimeout(function(){t.isBtn=!1},1e3)}else{a.setTime(a.getTime()-864e5*e);var s=a.getMonth()+1,o=a.getDate(),d=a.getFullYear();o=o<10?"0"+o:o,s=s<10?"0"+s:s;var l=d+"-"+s+"-"+o,c=this.getnowDay();this.dayList=[],this.dayList[0]=l,this.dayList[1]=c;var u=[],p=a.toUTCString(),v=(new Date).toUTCString();u[0]=p,u[1]=v,this.postData.time_cycle=u,this.isBtn=!0,setTimeout(function(){t.isBtn=!1},1e3)}this.SearchSubmit()}},deviceReportExcel:function(){var e=this;return n(regeneratorRuntime.mark(function t(){var a,i,n,r,o,l,c,u;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:for(t.prev=0,a="",i=!0,n=!1,r=void 0,t.prev=5,o=e.multipleSelection[Symbol.iterator]();!(i=(l=o.next()).done);i=!0)c=l.value,a+=c.device_sn+",";t.next=13;break;case 9:t.prev=9,t.t0=t.catch(5),n=!0,r=t.t0;case 13:t.prev=13,t.prev=14,!i&&o.return&&o.return();case 16:if(t.prev=16,!n){t.next=19;break}throw r;case 19:return t.finish(16);case 20:return t.finish(13);case 21:return a=a.substr(0,a.length-1),t.next=24,s.default.Post(d.default.operation.qrCreated,{sn:a});case 24:u=t.sent,window.location.href=u,t.next=32;break;case 28:t.prev=28,t.t1=t.catch(0),e.$notify({title:"温馨提示",message:"导出失败",type:"success"}),console.log(t.t1);case 32:case"end":return t.stop()}},t,e,[[0,28],[5,9,13,21],[14,,16,20]])}))()},blurSunmitSn:function(){var e=this;setTimeout(function(){e.aliSubmitBtnSn=!1},200)},querySearch:function(e,t){var a=this.addressList;t(e?a.filter(this.createFilter(e)):a)},createFilter:function(e){return function(t){return-1!=t.value.toLowerCase().indexOf(e.toLowerCase())}},handleSelectCb:function(e){this.postData.address_id=e.id,this.SearchSubmit()},handleIconClick:function(){""!=this.postData.address_id&&(this.postData.address_id="",this.address_name="",this.SearchSubmit())},getDataList:function(e,t){var a=this;return n(regeneratorRuntime.mark(function i(){var n,r,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return n=a.postData,a.deviceData=[],e&&(n.page_number=e),t&&(n.per_page=t),i.next=6,s.default.Post(d.default.device.replenishment,{per_page:n.per_page,page:n.page_number});case 6:r=i.sent,console.log(r),a.postData.per_page_code=parseInt(n.per_page),a.per_page_code=parseInt(n.per_page),a.count=r.count,o=new Map,o.set("pay","常规"),o.set("ad","分享朋友圈"),o.set("share","拉粉"),o.set("payAndintegral","M币加支付"),o.set("payAndfy","免费加支付"),a.deviceData=r.list;case 18:case"end":return i.stop()}},i,a)}))()},changePageNum:function(){this.postData.per_page!=this.per_page_code&&(""!=this.postData.per_page&&0!=this.postData.per_page||(this.postData.per_page=1),this.getDataList(this.currentPage))},topSplitAll:function(e){var t=this,a="",i="",r="",s=!0,o=!1,d=void 0;try{for(var l,c=e[Symbol.iterator]();!(s=(l=c.next()).done);s=!0){var u=l.value;a+=u.id+",",i+=u.sn+",",r+=u.coin_num+","}}catch(e){o=!0,d=e}finally{try{!s&&c.return&&c.return()}finally{if(o)throw d}}this.$confirm("此操作将批量启动设备, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(n(regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,PointsDevice({device_id:a,device_sn:i,coin_num:r});case 2:n=e.sent,t.$notify({title:"温馨提示",message:"启动成功",type:"success"});case 4:case"end":return e.stop()}},e,t)}))).catch(function(){t.$notify({title:"温馨提示",message:"已取消启动",type:"info"})})},SearchSubmit:function(){var e=this;return n(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.getDataList(1);case 1:case"end":return t.stop()}},t,e)}))()},handleSelectionChange:function(e){this.multipleSelection=e},handleCurrentChange:function(e){this.currentPage=e,this.getDataList(this.currentPage)},requireTemplateList:function(){var e=this;return n(regeneratorRuntime.mark(function t(){var a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.default.Post(d.default.personal.list,{mode:2});case 2:a=t.sent,a.data.forEach(function(e,t){e.value=e.address}),e.addressList=a.data;case 5:case"end":return t.stop()}},t,e)}))()},create:function(){this.requireTemplateList(),this.getDataList()}},created:function(){this.$store.commit("checkDeviceInfo","list"),this.create()},activated:function(){this.getDataList(this.postData.page_number,this.postData.per_page)},watch:{"postData.per_page":{handler:function(e,t){1!=this.postData.per_page&&(this.postData.per_page=this.postData.per_page.replace(/[^0-9]/g,""))},deep:!0},address_name:function(){""==this.address_name&&(this.postData.address_id="")}}}},817:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main-template",staticStyle:{"margin-top":"40px"}},[a("div",{staticClass:"main-container"},[a("div",{staticClass:"location-template noneBottomLink"},[a("el-row",[a("el-col",[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[e._v("\n              补货记录\n            ")])],1)],1)],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"补货详情",visible:e.dialogTableVisible},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[a("div",{staticClass:"search-template detailInput"},[a("el-form",{staticClass:"demo-form-inline",staticStyle:{"padding-left":"0"},attrs:{inline:!0,model:e.postData,labelWidth:"70px"}},[a("div",{staticClass:"grid-content bg-purple-dark form-grid-content"},[a("el-form-item",{staticClass:"needLeft",attrs:{label:"视　　图"}},[a("el-radio-group",{model:{value:e.postData.type,callback:function(t){e.$set(e.postData,"type",t)},expression:"postData.type"}},[a("el-radio-button",{attrs:{label:"月"}}),e._v(" "),a("el-radio-button",{attrs:{label:"日"}}),e._v(" "),a("el-radio-button",{attrs:{label:"周"}})],1)],1)],1)])],1),e._v(" "),a("div",{staticClass:"table-template"},[a("div",{staticClass:"table-title"},[a("button",{staticClass:"table-export",class:{"btn-noable":0==e.deviceData.length},attrs:{disabled:0==e.deviceData.length},on:{click:e.deviceReportExcelDeatil}},[a("span",[e._v("导出")])]),e._v(" "),a("span",{staticClass:"info-list"},[e._v("共"+e._s(e.count_detail)+"条列表项")])]),e._v(" "),a("el-table",{attrs:{"max-height":"300",data:e.deviceData,align:"center"}},[a("el-table-column",{attrs:{type:"index",width:"50",align:"center",label:"编号"}}),e._v(" "),a("el-table-column",{attrs:{prop:"device_sn",align:"center",label:"设备编号",width:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"device_sn",align:"center",label:"设备别名",width:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"date",align:"center",label:"时间",width:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"money",align:"center",label:"补货数",width:""}})],1),e._v(" "),a("div",{staticClass:"jump-ability clearfixed",staticStyle:{"padding-bottom":"20px"}},[a("div",{staticClass:"page-change"},[a("div",{staticClass:"block pagination-template"},[a("el-pagination",{attrs:{layout:"prev, pager, next,jumper",total:e.count_detail,"page-size":e.per_page_detail_code,small:""},on:{"current-change":e.handleCurrentChangeDetail}})],1)]),e._v(" "),a("div",{staticClass:"page-number"},[e._v("每页显示\n                      "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.per_page_detail,expression:"per_page_detail"}],domProps:{value:e.per_page_detail},on:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.changePageNumDetail()},blur:function(t){e.changePageNumDetail()},input:function(t){t.target.composing||(e.per_page_detail=t.target.value)}}}),e._v("条\n                  ")])])],1)]),e._v(" "),a("div",{staticClass:"table-template"},[a("el-table",{staticStyle:{width:"100%"},attrs:{"min-height":"390",data:e.deviceData,"highlight-current-row":""},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"index",width:"100",align:"center",label:"编号"}}),e._v(" "),a("el-table-column",{attrs:{label:"设备编号",property:"device_sn","min-width":"100"}}),e._v(" "),a("el-table-column",{attrs:{label:"设备别名",property:"device_prop.alias","min-width":"100"}}),e._v(" "),a("el-table-column",{attrs:{label:"补货日期",property:"created_at","min-width":"120"}}),e._v(" "),a("el-table-column",{attrs:{label:"补货前库存",property:"stock","min-width":"100"}}),e._v(" "),a("el-table-column",{attrs:{label:"总补货量",property:"number","min-width":"100"}})],1),e._v(" "),a("div",{staticClass:"jump-ability clearfixed"},[a("div",{staticClass:"jump-btn",class:{"jump-none":0==e.deviceData.length}}),e._v(" "),a("div",{staticClass:"page-change"},[a("div",{staticClass:"block pagination-template"},[a("el-pagination",{attrs:{layout:"prev, pager, next,jumper",total:e.count,"page-size":e.postData.per_page_code,small:""},on:{"current-change":e.handleCurrentChange}})],1)]),e._v(" "),a("div",{staticClass:"page-number"},[e._v("每页显示\n          "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.postData.per_page,expression:"postData.per_page"}],domProps:{value:e.postData.per_page},on:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.changePageNum()},blur:function(t){e.changePageNum()},input:function(t){t.target.composing||e.$set(e.postData,"per_page",t.target.value)}}}),e._v("条\n        ")])])],1)],1)])},staticRenderFns:[]}}});